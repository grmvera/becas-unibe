<div class="box-discapacidad">
  <!-- Tomamos requisitos dinámicos -->
  <ng-container *ngIf="(requisitos$ | async) as reqs">
    <!-- CUANDO HAY REQUISITOS: se muestra todo el formulario -->
    <ng-container *ngIf="reqs.length > 0; else bloqueSinRequisitos">

      <h3>Anexo carnet CONADIS / cédula de identidad</h3>
      <p class="descripcion">
        Suba el documento que valide la discapacidad. Este puede ser el carnet de CONADIS y la cédula de identidad.
        El documento que se suba aquí no se debe subir en el siguiente apartado. <strong>Debe ser un único archivo.</strong>
      </p>

      <div class="fila-discapacidad">
        <label for="archivoConadis">Suba su carnet CONADIS / cédula de identidad:</label>
        <input
          type="file"
          id="archivoConadis"
          (change)="onArchivoSeleccionado($event, 'conadis')"
          accept=".pdf,.jpg,.jpeg,.png"
          [disabled]="!puedeSubir" />
      </div>

      <hr />

      <h3>Anexar documentos</h3>
      <p class="descripcion">
        Suba un documento PDF, máximo 5 Mb. Los documentos deben seguir el siguiente orden:
      </p>

      <ol class="lista-requisitos">
        <li *ngFor="let r of reqs; index as i">{{ r }}</li>
      </ol>

      <div class="fila-discapacidad">
        <label for="archivoRequisitos">Suba el documento con todos los requisitos:</label>
        <input
          type="file"
          id="archivoRequisitos"
          (change)="onArchivoSeleccionado($event, 'requisitos')"
          accept=".pdf"
          [disabled]="!puedeSubir" />
      </div>

      <div class="resumen-seleccion">
        <strong>Servicio:</strong> {{ servicioActual || '—' }} |
        <strong>Tipo de beca:</strong> {{ becaActual || '—' }}
      </div>

      <div class="navegacion">
        <button type="button" class="btn-atras" (click)="emitirVolverAtras()">⬅ Atrás</button>
        <button type="button" class="btn-siguiente" (click)="subirArchivo()" [disabled]="!puedeFinalizar">
          Finalizar
        </button>
      </div>

    </ng-container>

    <!-- CUANDO NO HAY REQUISITOS: ocultar todo y solo mostrar aviso + Atrás -->
    <ng-template #bloqueSinRequisitos>
      <h3>Anexar documentos</h3>
      <p class="descripcion">
        Suba un documento PDF, máximo 5 Mb. Los documentos deben seguir el siguiente orden:
      </p>

      <div class="alerta">
        <strong>No hay requisitos configurados</strong> para este servicio {{ servicioActual || '—' }} {{ becaActual || '—' }}.
        <br />
        Falta instrucción. Por favor, comunícate con <strong>Bienestar Estudiantil</strong> para recibir indicaciones.
      </div>

      <div class="resumen-seleccion">
        <strong>Servicio:</strong> {{ servicioActual || '—' }} |
        <strong>Tipo de beca:</strong> {{ becaActual || '—' }}
      </div>

      <div class="navegacion">
        <button type="button" class="btn-atras" (click)="emitirVolverAtras()">⬅ Atrás</button>
        <!-- Sin botón Finalizar -->
      </div>
    </ng-template>
  </ng-container>
</div>
